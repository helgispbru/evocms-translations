import{a as B,Q as C,d as P,R,S as A,r as _,e as g,Z as k,i as U,o as p,k as z,h as e,g as w,V,t,j as o,A as x,m as E,W as D,X as H,Y as J,U as L,T}from"./index-B8mXUOvT.js";const Q={class:"row mb-1 align-items-center"},W={class:"col-4"},X={class:"col-8 py-2 ps-4"},Y={class:"row mb-1 align-items-center"},Z={class:"col-4"},q={class:"col-8 py-2 ps-4"},G={class:"row mb-1 align-items-center"},K={class:"col-4"},ee={class:"col-8 py-2 ps-4"},ae={class:"row mb-1 align-items-center"},se={class:"col-8"},te={key:0,class:"alert alert-success px-2 py-1",role:"alert"},oe={key:1,class:"alert alert-warning px-2 py-1",role:"alert"},le={class:"mt-3 text-end"},re={class:"btn btn-primary mx-1",type:"submit"},ne={class:"btn btn-secondary mx-1",type:"reset"},ce={__name:"entry-value",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup($){const{t:l}=B(),F=C("locale"),f=P.useToast(),v=R($,"modelValue"),r=A(),c=_(""),u=_(""),m=_(null),y=g(()=>{var s,a;return((a=(s=m.value)==null?void 0:s.meta)==null?void 0:a.valid)||!1});async function O(s){u.value="",c.value="";const a=Object.assign({},r.data,s,{locale:F.value});delete a.groups,delete a.languages;const M=`${L}/entries/group/${a.language_group_id}/key/${a.key_id}/language/${a.language_id}`;try{const n={method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)},d=await fetch(M,n),i=await d.json();if(!d.ok){const N=(i==null?void 0:i.error)||`${d.status} ${d.statusText}`,{errors:h}=i;h.hasOwnProperty("value")&&m.value.setErrors(h.value);const b=new Error(N);throw b.status=d.status,b}c.value=i.message||"",u.value=i.error||"",v.value.data={saved:!0},v.value.action="close"}catch(n){throw n.name==="TypeError"?f.error(`${l("toast.errornetwork")} ${n.message}`,T):f.error(`${l("toast.error")} ${n.message}`,T),n}}function S(){u.value="",c.value="",v.value.data={saved:!1},v.value.action="close"}const j=g(()=>{const s=Object.values(k(r.data.languages)).find(a=>a.id===parseInt(r.data.language_id));return s?s.title:"n/a"}),I=g(()=>{const s=Object.values(k(r.data.groups)).find(a=>a.id===parseInt(r.data.language_group_id));return s?s.title:"n/a"});return(s,a)=>(p(),U(o(J),{onSubmit:O,onReset:S,class:"needs-validation",name:"EntryValueForm","initial-values":{value:o(r).data.value}},{default:z(()=>[e("div",Q,[e("div",W,t(o(l)("entries.form.language")),1),e("div",X,[e("strong",null,t(j.value),1)])]),e("div",Y,[e("div",Z,t(o(l)("entries.form.group")),1),e("div",q,[e("strong",null,t(I.value),1)])]),e("div",G,[e("div",K,t(o(l)("entries.form.key")),1),e("div",ee,[e("strong",null,t(o(r).data.key),1)])]),e("div",ae,[e("label",{class:x(["col-4 col-form-label",{"pb-4":!y.value}]),for:"validationEntryValue"},t(o(l)("entries.form.value")),3),e("div",se,[E(o(D),{name:"value",ref_key:"valueField",ref:m,rules:"max:255",class:x(["form-control",{"is-invalid":!y.value}]),type:"text",autocomplete:"off",id:"validationEntryValue","aria-describedby":"validationEntryValueFeedback"},null,8,["class"]),E(o(H),{name:"value",as:"div",class:"invalid-feedback",id:"validationEntryValueFeedback"})])]),c.value.length?(p(),w("div",te,t(c.value),1)):V("",!0),u.value.length?(p(),w("div",oe,t(u.value),1)):V("",!0),e("div",le,[e("button",re,t(o(l)("btn.save")),1),e("button",ne,t(o(l)("btn.cancel")),1)])]),_:1},8,["initial-values"]))}};export{ce as default};
