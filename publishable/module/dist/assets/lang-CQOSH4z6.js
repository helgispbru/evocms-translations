import{a as A,Q as R,d as U,R as q,S as I,r as f,e as $,i as z,o as x,k as D,h as s,g as C,V as S,A as b,t as i,j as e,m as p,W as V,X as O,Y as H,T as _,U as E}from"./index-B8mXUOvT.js";const J={class:"row mb-1 align-items-center"},Q={class:"col-8"},W={class:"row mb-1 align-items-center"},X={class:"col-8"},Y={key:0,class:"alert alert-success px-2 py-1",role:"alert"},G={key:1,class:"alert alert-warning px-2 py-1",role:"alert"},K={class:"mt-3 text-end"},Z={class:"btn btn-primary mx-1",type:"submit"},ee={class:"btn btn-secondary mx-1",type:"reset"},te={__name:"lang",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(M){const{t:o}=A(),N=R("locale"),m=U.useToast(),v=q(M,"modelValue"),c=I(),d=f(""),t=f(""),h=f(null),y=f(null),w=$(()=>{var l,a;return((a=(l=h.value)==null?void 0:l.meta)==null?void 0:a.valid)||!1}),F=$(()=>{var l,a;return((a=(l=y.value)==null?void 0:l.meta)==null?void 0:a.valid)||!1});async function P(l){if(t.value="",d.value="",c.data.action=="edit"&&Number(c.data.id)==0)return t.value=o("languages.form.error.noid"),m.warning(t.value,_),!1;const a=Object.assign({},c.data,l,{locale:N.value});let k="",T="";switch(a.action){case"add":k="POST",T=`${E}/languages`;break;case"edit":k="PUT",T=`${E}/languages/${a.id}`;break;default:return t.value=o("languages.form.error.noaction"),m.error(t.value,_),!1}try{const r={method:k,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)},u=await fetch(T,r),n=await u.json();if(!u.ok){const B=(n==null?void 0:n.error)||`${u.status} ${u.statusText}`,{errors:g}=n;g.hasOwnProperty("code")&&h.value.setErrors(g.code),g.hasOwnProperty("title")&&y.value.setErrors(g.title);const L=new Error(B);throw L.status=u.status,L}d.value=n.message||"",t.value=n.error||"",v.value.data={saved:!0},v.value.action="close"}catch(r){throw r.name==="TypeError"?m.error(`${o("toast.errornetwork")} ${r.message}`,_):m.error(`${o("toast.error")} ${r.message}`,_),r}}function j(){t.value="",d.value="",v.value.data={saved:!1},v.value.action="close"}return(l,a)=>(x(),z(e(H),{onSubmit:P,onReset:j,class:"needs-validation",name:"LanguageForm","initial-values":{code:e(c).data.code,title:e(c).data.title}},{default:D(()=>[s("div",J,[s("label",{class:b(["col-4 col-form-label",{"pb-4":!w.value}]),for:"validationLanguageCode"},i(e(o)("languages.form.code")),3),s("div",Q,[p(e(V),{name:"code",ref_key:"codeField",ref:h,rules:"required|max:2",class:b(["form-control",{"is-invalid":!w.value}]),type:"text",autocomplete:"off",id:"validationLanguageCode","aria-describedby":"validationLanguageCodeFeedback"},null,8,["class"]),p(e(O),{name:"code",as:"div",class:"invalid-feedback",id:"validationLanguageCodeFeedback"})])]),s("div",W,[s("label",{class:b(["col-4 col-form-label",{"pb-4":!F.value}]),for:"validationLanguageTitle"},i(e(o)("languages.form.title")),3),s("div",X,[p(e(V),{name:"title",ref_key:"titleField",ref:y,rules:"required|max:20",class:b(["form-control",{"is-invalid":!F.value}]),type:"text",autocomplete:"off",id:"validationLanguageTitle","aria-describedby":"validationLanguageTitleFeedback"},null,8,["class"]),p(e(O),{name:"title",as:"div",class:"invalid-feedback",id:"validationLanguageTitleFeedback"})])]),d.value.length?(x(),C("div",Y,i(d.value),1)):S("",!0),t.value.length?(x(),C("div",G,i(t.value),1)):S("",!0),s("div",K,[s("button",Z,i(e(o)("btn.save")),1),s("button",ee,i(e(o)("btn.cancel")),1)])]),_:1},8,["initial-values"]))}};export{te as default};
