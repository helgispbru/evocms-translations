import{a as M,Q as N,d as B,R as C,S as I,r as v,e as k,Z as P,i as R,o as p,k as A,h as t,g as h,V as x,t as o,j as a,A as w,m as E,W as U,X as z,Y as D,U as H,T}from"./index-B8mXUOvT.js";const J={class:"row mb-1 align-items-center"},L={class:"col-4"},Q={class:"col-8 py-2 ps-4"},W={class:"row mb-1 align-items-center"},X={class:"col-8"},Y={key:0,class:"alert alert-success px-2 py-1",role:"alert"},Z={key:1,class:"alert alert-warning px-2 py-1",role:"alert"},q={class:"mt-3 text-end"},G={class:"btn btn-primary mx-1",type:"submit"},ee={class:"btn btn-secondary mx-1",type:"reset"},se={__name:"entry-key",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup($){const{t:r}=M(),F=N("locale"),_=B.useToast(),u=C($,"modelValue"),m=I(),i=v(""),c=v(""),y=v(null),f=k(()=>{var s,e;return((e=(s=y.value)==null?void 0:s.meta)==null?void 0:e.valid)||!1});async function S(s){c.value="",i.value="";const e=Object.assign({},m.data,s,{locale:F.value});delete e.groups,delete e.languages;const j=`${H}/entries/group/${e.language_group_id}/key/${e.key_id}`;try{const l={method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)},d=await fetch(j,l),n=await d.json();if(!d.ok){const K=(n==null?void 0:n.error)||`${d.status} ${d.statusText}`,{errors:g}=n;g.hasOwnProperty("key")&&y.value.setErrors(g.key);const b=new Error(K);throw b.status=d.status,b}i.value=n.message||"",c.value=n.error||"",u.value.data={saved:!0},u.value.action="close"}catch(l){throw l.name==="TypeError"?_.error(`${r("toast.errornetwork")} ${l.message}`,T):_.error(`${r("toast.error")} ${l.message}`,T),l}}function V(){c.value="",i.value="",u.value.data={saved:!1},u.value.action="close"}const O=k(()=>{const s=Object.values(P(m.data.groups)).find(e=>e.id===parseInt(m.data.language_group_id));return s?s.title:"n/a"});return(s,e)=>(p(),R(a(D),{onSubmit:S,onReset:V,class:"needs-validation",name:"EntryKeyForm","initial-values":{key:a(m).data.key}},{default:A(()=>[t("div",J,[t("div",L,o(a(r)("entries.form.group")),1),t("div",Q,[t("strong",null,o(O.value),1)])]),t("div",W,[t("label",{class:w(["col-4 col-form-label",{"pb-4":!f.value}]),for:"validationEntryKey"},o(a(r)("entries.form.key")),3),t("div",X,[E(a(U),{name:"key",ref_key:"keyField",ref:y,rules:"max:255",class:w(["form-control",{"is-invalid":!f.value}]),type:"text",autocomplete:"off",id:"validationEntryKey","aria-describedby":"validationEntryKeyFeedback"},null,8,["class"]),E(a(z),{name:"key",as:"div",class:"invalid-feedback",id:"validationEntryKeyFeedback"})])]),i.value.length?(p(),h("div",Y,o(i.value),1)):x("",!0),c.value.length?(p(),h("div",Z,o(c.value),1)):x("",!0),t("div",q,[t("button",G,o(a(r)("btn.save")),1),t("button",ee,o(a(r)("btn.cancel")),1)])]),_:1},8,["initial-values"]))}};export{se as default};
